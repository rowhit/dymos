

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Phase Cannonball &#8212; dymos 0.15.0 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multibranch Trajectory" href="multibranch_trajectory.html" />
    <link rel="prev" title="Supersonic Interceptor Minimum Time Climb" href="min_time_climb.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="multibranch_trajectory.html" title="Multibranch Trajectory"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="min_time_climb.html" title="Supersonic Interceptor Minimum Time Climb"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">dymos 0.15.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">Dymos by Example</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Multi-Phase Cannonball</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="multi-phase-cannonball">
<h1>Multi-Phase Cannonball<a class="headerlink" href="#multi-phase-cannonball" title="Permalink to this headline">¶</a></h1>
<p>Maximizing the range of a cannonball in a vacuum is a typical introductory problem for optimal
control.  In this example we’re going to demonstrate a more multidisciplinary take on the problem.
We will assume a density of the metal from which the cannonball is constructed, and a cannon that can
fire any diameter cannonball but is limited to a maximum muzzle energy.  If we make the cannonball
large it will be heavy and the cannon will not be capable of propelling it very far.  If we make
the cannonball too small, it will have a low ballistic coefficient and not be able to sustain its
momentum in the presence of atmospheric drag.  Somewhere between these two extremes is the cannonball
radius which allows for maximum range flight.</p>
<p>The presense of atmospheric drag also means that we typically want to launch the cannonball with more
horizontal velocity, and thus use a launch angle less than 45 degrees.</p>
<p>In this problem we will find the optimal design for the cannonball (its radius) and the optimal
flight profile (its launch angle) simultaneously.</p>
<div class="section" id="using-two-phases-to-capture-an-intermediate-boundary-constraint">
<h2>Using two phases to capture an intermediate boundary constraint<a class="headerlink" href="#using-two-phases-to-capture-an-intermediate-boundary-constraint" title="Permalink to this headline">¶</a></h2>
<p>This problem demonstrates the use of two phases to capture the state of the system at an event
in the trajectory.  Here, we have the first phase (ascent) terminate when the flight path
angle reaches zero (apogee).  The descent phase follows until the cannonball impacts the ground.</p>
<p>The dynamics are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{d v}{d t} &amp;= \frac{T}{m} \cos(\alpha) - \frac{D}{m} - g \sin(\gamma) \\
\frac{d \gamma}{d t} &amp;= \frac{T}{mv} \sin(\alpha) + \frac{L}{mv} - \frac{g \cos(\gamma)}{v} \\
\frac{d h}{d t} &amp;= v \sin(\gamma) \\
\frac{d r}{d t} &amp;= v \cos(\gamma)\end{split}\]</div>
<p>The initial conditions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}r_0 &amp;= 0 \, \mathrm{m} \\
h_0 &amp;= 100 \, \mathrm{m} \\
v_0 &amp;= \mathrm{free} \\
\gamma_0 &amp;= \mathrm{free} \\\end{split}\]</div>
<p>and the final conditions are</p>
<div class="math notranslate nohighlight">
\[h_f &amp;= 0 \, \mathrm{m}\]</div>
</div>
<div class="section" id="designing-a-cannonball-for-maximum-range">
<h2>Designing a cannonball for maximum range<a class="headerlink" href="#designing-a-cannonball-for-maximum-range" title="Permalink to this headline">¶</a></h2>
<p>This problem demonstrates a very simple vehicle design capability that is run
before the trajectory.</p>
<p>We assume our cannon can shoot a cannonball with some fixed kinetic energy and that
our cannonball is made of solid iron.  The volume (and mass) of the cannonball is proportional
to its radius cubed, while the cross-sectional area is proportional to its radius squared.
If we increase the size of the cannonball, the ballistic coefficient</p>
<div class="math notranslate nohighlight">
\[BC = \frac{m}{C_D A}\]</div>
<p>will increase, meaning the cannonball overcome air resistance more easily and thus carry more distance.</p>
<p>However, making the cannonball larger also increases its mass.  Our cannon can impart the cannonball
with, at most, 400 kJ of kinetic energy.  So making the cannonball larger will decrease the
initial velocity, and thus negatively impact its range.</p>
<p>We therefore have a design that affects the objective in competing ways.  We cannot make the
cannonball too large, as it will be too heavy to shoot.  We also cannot make the cannonball too
small, as it will be more susceptible to air resistance.  Somewhere in between is the sweet spot
that provides the maximum range cannonball.</p>
</div>
<div class="section" id="building-and-running-the-problem">
<h2>Building and running the problem<a class="headerlink" href="#building-and-running-the-problem" title="Permalink to this headline">¶</a></h2>
<p>The following code instantiates our problem, our trajectory, two phases, and links them
accordingly.  The initial flight path angle is free, since 45 degrees is not necessarily optimal
once air resistance is taken into account.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="k">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">openmdao.utils.assert_utils</span> <span class="kn">import</span> <span class="n">assert_near_equal</span>

<span class="kn">import</span> <span class="nn">dymos</span> <span class="k">as</span> <span class="nn">dm</span>
<span class="kn">from</span> <span class="nn">dymos.examples.cannonball.size_comp</span> <span class="kn">import</span> <span class="n">CannonballSizeComp</span>
<span class="kn">from</span> <span class="nn">dymos.examples.cannonball.cannonball_phase</span> <span class="kn">import</span> <span class="n">CannonballPhase</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">om</span><span class="o">.</span><span class="n">Group</span><span class="p">())</span>

<span class="n">p</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">pyOptSparseDriver</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">declare_coloring</span><span class="p">()</span>

<span class="n">external_params</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;external_params&#39;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">IndepVarComp</span><span class="p">())</span>

<span class="n">external_params</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">external_params</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;dens&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">7.87</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;g/cm**3&#39;</span><span class="p">)</span>

<span class="n">external_params</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">ref0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;size_comp&#39;</span><span class="p">,</span> <span class="n">CannonballSizeComp</span><span class="p">())</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;traj&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">())</span>

<span class="n">transcription</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">Radau</span><span class="p">(</span><span class="n">num_segments</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ascent</span> <span class="o">=</span> <span class="n">CannonballPhase</span><span class="p">(</span><span class="n">transcription</span><span class="o">=</span><span class="n">transcription</span><span class="p">)</span>

<span class="n">ascent</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s1">&#39;ascent&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="p">)</span>

<span class="c1"># All initial states except flight path angle are fixed</span>
<span class="c1"># Final flight path angle is fixed (we will set it to zero so that the phase ends at apogee)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_time_options</span><span class="p">(</span><span class="n">fix_initial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">duration_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">duration_ref</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ascent</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;aero.S&#39;</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m**2&#39;</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eom.m&#39;</span><span class="p">,</span> <span class="s1">&#39;kinetic_energy.m&#39;</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="c1"># Limit the muzzle energy</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">add_boundary_constraint</span><span class="p">(</span><span class="s1">&#39;kinetic_energy.ke&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;J&#39;</span><span class="p">,</span>
                               <span class="n">upper</span><span class="o">=</span><span class="mi">400000</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>

<span class="c1"># Second Phase (descent)</span>
<span class="n">transcription</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">GaussLobatto</span><span class="p">(</span><span class="n">num_segments</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">descent</span> <span class="o">=</span> <span class="n">CannonballPhase</span><span class="p">(</span><span class="n">transcription</span><span class="o">=</span><span class="n">transcription</span><span class="p">)</span>

<span class="n">traj</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s1">&#39;descent&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="p">)</span>

<span class="c1"># All initial states and time are free (they will be linked to the final states of ascent.</span>
<span class="c1"># Final altitude is fixed (we will set it to zero so that the phase ends at ground impact)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">set_time_options</span><span class="p">(</span><span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">duration_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                         <span class="n">duration_ref</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">descent</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;aero.S&#39;</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m**2&#39;</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eom.m&#39;</span><span class="p">,</span> <span class="s1">&#39;kinetic_energy.m&#39;</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="n">descent</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;final&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Add internally-managed design parameters to the trajectory.</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;CD&#39;</span><span class="p">,</span>
                          <span class="n">targets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aero.CD&#39;</span><span class="p">],</span> <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aero.CD&#39;</span><span class="p">]},</span>
                          <span class="n">val</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;CL&#39;</span><span class="p">,</span>
                          <span class="n">targets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aero.CL&#39;</span><span class="p">],</span> <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aero.CL&#39;</span><span class="p">]},</span>
                          <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span>
                          <span class="n">targets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eom.T&#39;</span><span class="p">],</span> <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eom.T&#39;</span><span class="p">]},</span>
                          <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
                          <span class="n">targets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eom.alpha&#39;</span><span class="p">],</span> <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eom.alpha&#39;</span><span class="p">]},</span>
                          <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add externally-provided design parameters to the trajectory.</span>
<span class="c1"># In this case, we connect &#39;m&#39; to pre-existing input parameters named &#39;mass&#39; in each phase.</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                         <span class="n">targets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="s1">&#39;mass&#39;</span><span class="p">})</span>

<span class="c1"># In this case, by omitting targets, we&#39;re connecting these parameters to parameters</span>
<span class="c1"># with the same name in each phase.</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m**2&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>

<span class="c1"># Link Phases (link time and all state variables)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">link_phases</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">,</span> <span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

<span class="c1"># Issue Connections</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;external_params.radius&#39;</span><span class="p">,</span> <span class="s1">&#39;size_comp.radius&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;external_params.dens&#39;</span><span class="p">,</span> <span class="s1">&#39;size_comp.dens&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;size_comp.mass&#39;</span><span class="p">,</span> <span class="s1">&#39;traj.input_parameters:m&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;size_comp.S&#39;</span><span class="p">,</span> <span class="s1">&#39;traj.input_parameters:S&#39;</span><span class="p">)</span>

<span class="c1"># Finish Problem Setup</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">linear_solver</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">DirectSolver</span><span class="p">()</span>

<span class="n">p</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s1">&#39;ex_two_phase_cannonball.db&#39;</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># Set Initial Guesses</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;external_params.radius&#39;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;external_params.dens&#39;</span><span class="p">,</span> <span class="mf">7.87</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;g/cm**3&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.design_parameters:CD&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.design_parameters:CL&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.design_parameters:T&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.t_initial&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.t_duration&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:r&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:h&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:v&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:gam&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">),</span>
          <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.t_initial&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.t_duration&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:r&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:h&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:v&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:gam&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">),</span>
          <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">dm</span><span class="o">.</span><span class="n">run_problem</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:r&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">exp_out</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;optimal radius: </span><span class="si">{0:6.4f}</span><span class="s1"> m &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;external_params.radius&#39;</span><span class="p">,</span>
                                                     <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cannonball mass: </span><span class="si">{0:6.4f}</span><span class="s1"> kg &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;size_comp.mass&#39;</span><span class="p">,</span>
                                                       <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;launch angle: </span><span class="si">{0:6.4f}</span><span class="s1"> &#39;</span>
      <span class="s1">&#39;deg &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:gam&#39;</span><span class="p">,</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;maximum range: </span><span class="si">{0:6.4f}</span><span class="s1"> &#39;</span>
      <span class="s1">&#39;m &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:r&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">time_imp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.time&#39;</span><span class="p">),</span>
            <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.time&#39;</span><span class="p">)}</span>

<span class="n">time_exp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.time&#39;</span><span class="p">),</span>
            <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.time&#39;</span><span class="p">)}</span>

<span class="n">r_imp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:r&#39;</span><span class="p">),</span>
         <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:r&#39;</span><span class="p">)}</span>

<span class="n">r_exp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:r&#39;</span><span class="p">),</span>
         <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:r&#39;</span><span class="p">)}</span>

<span class="n">h_imp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:h&#39;</span><span class="p">),</span>
         <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:h&#39;</span><span class="p">)}</span>

<span class="n">h_exp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:h&#39;</span><span class="p">),</span>
         <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:h&#39;</span><span class="p">)}</span>

<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_imp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="n">h_imp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_imp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="n">h_imp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_exp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="n">h_exp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_exp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="n">h_exp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;range (m)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;altitude (m)&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;gam&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states</span><span class="p">):</span>
    <span class="n">x_imp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">)),</span>
             <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">))}</span>

    <span class="n">x_exp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.states:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">)),</span>
             <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.states:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state</span><span class="p">))}</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_imp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="n">x_imp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_imp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="n">x_imp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_exp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="n">x_exp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_exp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="n">x_exp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">p_imp</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.input_parameters:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param</span><span class="p">)),</span>
        <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.input_parameters:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param</span><span class="p">))}</span>

    <span class="n">p_exp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.timeseries.&#39;</span>
                                       <span class="s1">&#39;input_parameters:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param</span><span class="p">)),</span>
             <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="n">exp_out</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.timeseries.&#39;</span>
                                        <span class="s1">&#39;input_parameters:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param</span><span class="p">))}</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_imp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="n">p_imp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_imp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="n">p_imp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_exp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="n">p_exp</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_exp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="n">p_exp</span><span class="p">[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>--- Linkage Report [traj] ---
     ascent      descent
        time++         =  time--       
        states:r++     =  states:r--   
        states:v++     =  states:v--   
        states:gam++   =  states:gam-- 
        states:h++     =  states:h--   
----------------------------
Full total jacobian was computed 3 times, taking 0.117660 seconds.
Total jacobian shape: (87, 88) 


Jacobian shape: (87, 88)  (15.03% nonzero)
FWD solves: 23   REV solves: 0
Total colors vs. total size: 23 vs 88  (73.9% improvement)

Sparsity computed using tolerance: 1e-25
Time to compute sparsity: 0.117660 sec.
Time to compute coloring: 0.003405 sec.


Optimization Problem -- Optimization using pyOpt_sparse
================================================================================
    Objective Function: _objfunc

    Solution: 
--------------------------------------------------------------------------------
    Total Time:                    2.7133
       User Objective Time :       0.8904
       User Sensitivity Time :     1.1653
       Interface Time :            0.4707
       Opt Solver Time:            0.1869
    Calls to Objective Function :     103
    Calls to Sens Function :           87


   Objectives
      Index  Name                                                 Value          Optimum
          0  traj.phases.descent.indep_states.states:r    -3.183254E+03     0.000000E+00

   Variables (c - continuous, i - integer, d - discrete)
      Index  Name                                            Type      Lower Bound            Value      Upper Bound     Status
          0  external_params.radius_0                           c     0.000000E+00     3.539195E-01     1.000000E+00           
          1  traj.phases.ascent.time_extents.t_duration_0       c     1.000000E-02     1.064960E-01     1.000000E+00           
          2  traj.phases.ascent.indep_states.states:r_0         c    -1.000000E+21     3.231186E+02     1.000000E+21           
          3  traj.phases.ascent.indep_states.states:r_1         c    -1.000000E+21     6.617157E+02     1.000000E+21           
          4  traj.phases.ascent.indep_states.states:r_2         c    -1.000000E+21     7.552860E+02     1.000000E+21           
          5  traj.phases.ascent.indep_states.states:r_3         c    -1.000000E+21     9.434874E+02     1.000000E+21           
          6  traj.phases.ascent.indep_states.states:r_4         c    -1.000000E+21     1.165684E+03     1.000000E+21           
          7  traj.phases.ascent.indep_states.states:r_5         c    -1.000000E+21     1.229408E+03     1.000000E+21           
          8  traj.phases.ascent.indep_states.states:r_6         c    -1.000000E+21     1.364776E+03     1.000000E+21           
          9  traj.phases.ascent.indep_states.states:r_7         c    -1.000000E+21     1.532513E+03     1.000000E+21           
         10  traj.phases.ascent.indep_states.states:r_8         c    -1.000000E+21     1.581881E+03     1.000000E+21           
         11  traj.phases.ascent.indep_states.states:r_9         c    -1.000000E+21     1.688966E+03     1.000000E+21           
         12  traj.phases.ascent.indep_states.states:r_10        c    -1.000000E+21     1.825162E+03     1.000000E+21           
         13  traj.phases.ascent.indep_states.states:r_11        c    -1.000000E+21     1.865882E+03     1.000000E+21           
         14  traj.phases.ascent.indep_states.states:r_12        c    -1.000000E+21     1.955232E+03     1.000000E+21           
         15  traj.phases.ascent.indep_states.states:r_13        c    -1.000000E+21     2.070651E+03     1.000000E+21           
         16  traj.phases.ascent.indep_states.states:r_14        c    -1.000000E+21     2.105493E+03     1.000000E+21           
         17  traj.phases.ascent.indep_states.states:h_0         c    -1.000000E+21     1.995390E+02     1.000000E+21           
         18  traj.phases.ascent.indep_states.states:h_1         c    -1.000000E+21     4.003400E+02     1.000000E+21           
         19  traj.phases.ascent.indep_states.states:h_2         c    -1.000000E+21     4.538400E+02     1.000000E+21           
         20  traj.phases.ascent.indep_states.states:h_3         c    -1.000000E+21     5.574740E+02     1.000000E+21           
         21  traj.phases.ascent.indep_states.states:h_4         c    -1.000000E+21     6.712350E+02     1.000000E+21           
         22  traj.phases.ascent.indep_states.states:h_5         c    -1.000000E+21     7.017572E+02     1.000000E+21           
         23  traj.phases.ascent.indep_states.states:h_6         c    -1.000000E+21     7.626709E+02     1.000000E+21           
         24  traj.phases.ascent.indep_states.states:h_7         c    -1.000000E+21     8.293947E+02     1.000000E+21           
         25  traj.phases.ascent.indep_states.states:h_8         c    -1.000000E+21     8.468893E+02     1.000000E+21           
         26  traj.phases.ascent.indep_states.states:h_9         c    -1.000000E+21     8.809007E+02     1.000000E+21           
         27  traj.phases.ascent.indep_states.states:h_10        c    -1.000000E+21     9.153053E+02     1.000000E+21           
         28  traj.phases.ascent.indep_states.states:h_11        c    -1.000000E+21     9.234281E+02     1.000000E+21           
         29  traj.phases.ascent.indep_states.states:h_12        c    -1.000000E+21     9.373014E+02     1.000000E+21           
         30  traj.phases.ascent.indep_states.states:h_13        c    -1.000000E+21     9.463092E+02     1.000000E+21           
         31  traj.phases.ascent.indep_states.states:h_14        c    -1.000000E+21     9.468532E+02     1.000000E+21           
         32  traj.phases.ascent.indep_states.states:gam_0       c    -1.000000E+21     5.588811E-01     1.000000E+21           
         33  traj.phases.ascent.indep_states.states:gam_1       c    -1.000000E+21     5.461726E-01     1.000000E+21           
         34  traj.phases.ascent.indep_states.states:gam_2       c    -1.000000E+21     5.228744E-01     1.000000E+21           
         35  traj.phases.ascent.indep_states.states:gam_3       c    -1.000000E+21     5.141316E-01     1.000000E+21           
         36  traj.phases.ascent.indep_states.states:gam_4       c    -1.000000E+21     4.911925E-01     1.000000E+21           
         37  traj.phases.ascent.indep_states.states:gam_5       c    -1.000000E+21     4.530551E-01     1.000000E+21           
         38  traj.phases.ascent.indep_states.states:gam_6       c    -1.000000E+21     4.393603E-01     1.000000E+21           
         39  traj.phases.ascent.indep_states.states:gam_7       c    -1.000000E+21     4.048514E-01     1.000000E+21           
         40  traj.phases.ascent.indep_states.states:gam_8       c    -1.000000E+21     3.498274E-01     1.000000E+21           
         41  traj.phases.ascent.indep_states.states:gam_9       c    -1.000000E+21     3.305542E-01     1.000000E+21           
         42  traj.phases.ascent.indep_states.states:gam_10      c    -1.000000E+21     2.829367E-01     1.000000E+21           
         43  traj.phases.ascent.indep_states.states:gam_11      c    -1.000000E+21     2.092132E-01     1.000000E+21           
         44  traj.phases.ascent.indep_states.states:gam_12      c    -1.000000E+21     1.839306E-01     1.000000E+21           
         45  traj.phases.ascent.indep_states.states:gam_13      c    -1.000000E+21     1.226160E-01     1.000000E+21           
         46  traj.phases.ascent.indep_states.states:gam_14      c    -1.000000E+21     3.070923E-02     1.000000E+21           
         47  traj.phases.ascent.indep_states.states:v_0         c    -1.000000E+21     5.753436E+02     1.000000E+21           
         48  traj.phases.ascent.indep_states.states:v_1         c    -1.000000E+21     4.377122E+02     1.000000E+21           
         49  traj.phases.ascent.indep_states.states:v_2         c    -1.000000E+21     3.333844E+02     1.000000E+21           
         50  traj.phases.ascent.indep_states.states:v_3         c    -1.000000E+21     3.071239E+02     1.000000E+21           
         51  traj.phases.ascent.indep_states.states:v_4         c    -1.000000E+21     2.628449E+02     1.000000E+21           
         52  traj.phases.ascent.indep_states.states:v_5         c    -1.000000E+21     2.189800E+02     1.000000E+21           
         53  traj.phases.ascent.indep_states.states:v_6         c    -1.000000E+21     2.076293E+02     1.000000E+21           
         54  traj.phases.ascent.indep_states.states:v_7         c    -1.000000E+21     1.856223E+02     1.000000E+21           
         55  traj.phases.ascent.indep_states.states:v_8         c    -1.000000E+21     1.616742E+02     1.000000E+21           
         56  traj.phases.ascent.indep_states.states:v_9         c    -1.000000E+21     1.552348E+02     1.000000E+21           
         57  traj.phases.ascent.indep_states.states:v_10        c    -1.000000E+21     1.422734E+02     1.000000E+21           
         58  traj.phases.ascent.indep_states.states:v_11        c    -1.000000E+21     1.276770E+02     1.000000E+21           
         59  traj.phases.ascent.indep_states.states:v_12        c    -1.000000E+21     1.237086E+02     1.000000E+21           
         60  traj.phases.ascent.indep_states.states:v_13        c    -1.000000E+21     1.156786E+02     1.000000E+21           
         61  traj.phases.ascent.indep_states.states:v_14        c    -1.000000E+21     1.067061E+02     1.000000E+21           
         62  traj.phases.ascent.indep_states.states:v_15        c    -1.000000E+21     1.043151E+02     1.000000E+21           
         63  traj.phases.descent.time_extents.t_initial_0       c     5.000000E-01     1.064960E+01     1.000000E+02           
         64  traj.phases.descent.time_extents.t_duration_0      c     5.000000E-03     1.617372E-01     1.000000E+00           
         65  traj.phases.descent.indep_states.states:r_0        c    -1.000000E+21     2.105493E+03     1.000000E+21           
         66  traj.phases.descent.indep_states.states:r_1        c    -1.000000E+21     2.410921E+03     1.000000E+21           
         67  traj.phases.descent.indep_states.states:r_2        c    -1.000000E+21     2.663716E+03     1.000000E+21           
         68  traj.phases.descent.indep_states.states:r_3        c    -1.000000E+21     2.873405E+03     1.000000E+21           
         69  traj.phases.descent.indep_states.states:r_4        c    -1.000000E+21     3.045144E+03     1.000000E+21           
         70  traj.phases.descent.indep_states.states:r_5        c    -1.000000E+21     3.183254E+03     1.000000E+21           
         71  traj.phases.descent.indep_states.states:h_0        c    -1.000000E+21     9.468532E+02     1.000000E+21           
         72  traj.phases.descent.indep_states.states:h_1        c    -1.000000E+21     8.987452E+02     1.000000E+21           
         73  traj.phases.descent.indep_states.states:h_2        c    -1.000000E+21     7.652649E+02     1.000000E+21           
         74  traj.phases.descent.indep_states.states:h_3        c    -1.000000E+21     5.610567E+02     1.000000E+21           
         75  traj.phases.descent.indep_states.states:h_4        c    -1.000000E+21     3.010268E+02     1.000000E+21           
         76  traj.phases.descent.indep_states.states:gam_0      c    -1.000000E+21    -3.206044E-19     1.000000E+21           
         77  traj.phases.descent.indep_states.states:gam_1      c    -1.000000E+21    -3.251299E-01     1.000000E+21           
         78  traj.phases.descent.indep_states.states:gam_2      c    -1.000000E+21    -6.397925E-01     1.000000E+21           
         79  traj.phases.descent.indep_states.states:gam_3      c    -1.000000E+21    -8.902037E-01     1.000000E+21           
         80  traj.phases.descent.indep_states.states:gam_4      c    -1.000000E+21    -1.071778E+00     1.000000E+21           
         81  traj.phases.descent.indep_states.states:gam_5      c    -1.000000E+21    -1.201149E+00     1.000000E+21           
         82  traj.phases.descent.indep_states.states:v_0        c    -1.000000E+21     1.043151E+02     1.000000E+21           
         83  traj.phases.descent.indep_states.states:v_1        c    -1.000000E+21     9.031789E+01     1.000000E+21           
         84  traj.phases.descent.indep_states.states:v_2        c    -1.000000E+21     8.870191E+01     1.000000E+21           
         85  traj.phases.descent.indep_states.states:v_3        c    -1.000000E+21     9.333962E+01     1.000000E+21           
         86  traj.phases.descent.indep_states.states:v_4        c    -1.000000E+21     9.961109E+01     1.000000E+21           
         87  traj.phases.descent.indep_states.states:v_5        c    -1.000000E+21     1.050676E+02     1.000000E+21           

   Constraints (i - inequality, e - equality)
      Index  Name                                                             Type          Lower           Value           Upper    Status  Lagrange Multiplier (N/A)
          0  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    2.797913E-09    0.000000E+00              9.00000E+100
          1  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    1.646518E-09    0.000000E+00              9.00000E+100
          2  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    1.012707E-09    0.000000E+00              9.00000E+100
          3  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    8.257715E-10    0.000000E+00              9.00000E+100
          4  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    5.899233E-10    0.000000E+00              9.00000E+100
          5  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    3.857353E-10    0.000000E+00              9.00000E+100
          6  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    3.349759E-10    0.000000E+00              9.00000E+100
          7  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    2.431125E-10    0.000000E+00              9.00000E+100
          8  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    1.507346E-10    0.000000E+00              9.00000E+100
          9  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    1.269742E-10    0.000000E+00              9.00000E+100
         10  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    8.220788E-11    0.000000E+00              9.00000E+100
         11  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    3.359748E-11    0.000000E+00              9.00000E+100
         12  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00    2.241345E-11    0.000000E+00              9.00000E+100
         13  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00   -3.601892E-12    0.000000E+00              9.00000E+100
         14  traj.phases.ascent.collocation_constraint.defects:r                 e   0.000000E+00   -2.995018E-11    0.000000E+00              9.00000E+100
         15  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    4.648801E-09    0.000000E+00              9.00000E+100
         16  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    2.138222E-09    0.000000E+00              9.00000E+100
         17  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    9.847390E-10    0.000000E+00              9.00000E+100
         18  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    6.852977E-10    0.000000E+00              9.00000E+100
         19  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    3.609459E-10    0.000000E+00              9.00000E+100
         20  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    1.360546E-10    0.000000E+00              9.00000E+100
         21  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    8.919979E-11    0.000000E+00              9.00000E+100
         22  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00    2.105139E-11    0.000000E+00              9.00000E+100
         23  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -2.637856E-11    0.000000E+00              9.00000E+100
         24  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -3.371855E-11    0.000000E+00              9.00000E+100
         25  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -4.314703E-11    0.000000E+00              9.00000E+100
         26  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -4.115691E-11    0.000000E+00              9.00000E+100
         27  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -3.774041E-11    0.000000E+00              9.00000E+100
         28  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -2.770657E-11    0.000000E+00              9.00000E+100
         29  traj.phases.ascent.collocation_constraint.defects:h                 e   0.000000E+00   -7.408565E-12    0.000000E+00              9.00000E+100
         30  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    4.783522E-13    0.000000E+00              9.00000E+100
         31  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    2.941893E-13    0.000000E+00              9.00000E+100
         32  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    2.040134E-13    0.000000E+00              9.00000E+100
         33  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    1.554412E-13    0.000000E+00              9.00000E+100
         34  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    1.094037E-13    0.000000E+00              9.00000E+100
         35  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    7.081499E-14    0.000000E+00              9.00000E+100
         36  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    5.996699E-14    0.000000E+00              9.00000E+100
         37  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    4.238702E-14    0.000000E+00              9.00000E+100
         38  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    2.582682E-14    0.000000E+00              9.00000E+100
         39  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    2.119351E-14    0.000000E+00              9.00000E+100
         40  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    1.287277E-14    0.000000E+00              9.00000E+100
         41  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00    2.468142E-15    0.000000E+00              9.00000E+100
         42  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00   -1.049330E-15    0.000000E+00              9.00000E+100
         43  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00   -9.074487E-15    0.000000E+00              9.00000E+100
         44  traj.phases.ascent.collocation_constraint.defects:gam               e   0.000000E+00   -2.206549E-14    0.000000E+00              9.00000E+100
         45  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    1.464048E-08    0.000000E+00              9.00000E+100
         46  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    5.022248E-09    0.000000E+00              9.00000E+100
         47  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    1.987064E-09    0.000000E+00              9.00000E+100
         48  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    1.419130E-09    0.000000E+00              9.00000E+100
         49  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    8.345416E-10    0.000000E+00              9.00000E+100
         50  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    4.660742E-10    0.000000E+00              9.00000E+100
         51  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    3.936580E-10    0.000000E+00              9.00000E+100
         52  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    2.807395E-10    0.000000E+00              9.00000E+100
         53  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    1.881610E-10    0.000000E+00              9.00000E+100
         54  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    1.675220E-10    0.000000E+00              9.00000E+100
         55  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    1.309469E-10    0.000000E+00              9.00000E+100
         56  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    9.633925E-11    0.000000E+00              9.00000E+100
         57  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    8.786989E-11    0.000000E+00              9.00000E+100
         58  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    7.191487E-11    0.000000E+00              9.00000E+100
         59  traj.phases.ascent.collocation_constraint.defects:v                 e   0.000000E+00    5.539611E-11    0.000000E+00              9.00000E+100
         60  traj.phases.descent.collocation_constraint.defects:r                e   0.000000E+00    2.905208E-11    0.000000E+00              9.00000E+100
         61  traj.phases.descent.collocation_constraint.defects:r                e   0.000000E+00   -5.700092E-12    0.000000E+00              9.00000E+100
         62  traj.phases.descent.collocation_constraint.defects:r                e   0.000000E+00   -5.277182E-11    0.000000E+00              9.00000E+100
         63  traj.phases.descent.collocation_constraint.defects:r                e   0.000000E+00   -1.012456E-10    0.000000E+00              9.00000E+100
         64  traj.phases.descent.collocation_constraint.defects:r                e   0.000000E+00   -1.435366E-10    0.000000E+00              9.00000E+100
         65  traj.phases.descent.collocation_constraint.defects:h                e   0.000000E+00   -1.910565E-11    0.000000E+00              9.00000E+100
         66  traj.phases.descent.collocation_constraint.defects:h                e   0.000000E+00   -6.598776E-11    0.000000E+00              9.00000E+100
         67  traj.phases.descent.collocation_constraint.defects:h                e   0.000000E+00   -1.132663E-10    0.000000E+00              9.00000E+100
         68  traj.phases.descent.collocation_constraint.defects:h                e   0.000000E+00   -1.367792E-10    0.000000E+00              9.00000E+100
         69  traj.phases.descent.collocation_constraint.defects:h                e   0.000000E+00   -1.390547E-10    0.000000E+00              9.00000E+100
         70  traj.phases.descent.collocation_constraint.defects:gam              e   0.000000E+00    1.083447E-13    0.000000E+00              9.00000E+100
         71  traj.phases.descent.collocation_constraint.defects:gam              e   0.000000E+00    1.671296E-13    0.000000E+00              9.00000E+100
         72  traj.phases.descent.collocation_constraint.defects:gam              e   0.000000E+00    8.933328E-14    0.000000E+00              9.00000E+100
         73  traj.phases.descent.collocation_constraint.defects:gam              e   0.000000E+00    4.085090E-15    0.000000E+00              9.00000E+100
         74  traj.phases.descent.collocation_constraint.defects:gam              e   0.000000E+00   -4.091823E-14    0.000000E+00              9.00000E+100
         75  traj.phases.descent.collocation_constraint.defects:v                e   0.000000E+00    1.335916E-10    0.000000E+00              9.00000E+100
         76  traj.phases.descent.collocation_constraint.defects:v                e   0.000000E+00    8.750011E-11    0.000000E+00              9.00000E+100
         77  traj.phases.descent.collocation_constraint.defects:v                e   0.000000E+00    8.442938E-11    0.000000E+00              9.00000E+100
         78  traj.phases.descent.collocation_constraint.defects:v                e   0.000000E+00    9.305493E-11    0.000000E+00              9.00000E+100
         79  traj.phases.descent.collocation_constraint.defects:v                e   0.000000E+00    9.994015E-11    0.000000E+00              9.00000E+100
         80  traj.linkages.ascent|descent_gam                                    e   0.000000E+00   -3.206044E-19    0.000000E+00              9.00000E+100
         81  traj.linkages.ascent|descent_h                                      e   0.000000E+00    0.000000E+00    0.000000E+00              9.00000E+100
         82  traj.linkages.ascent|descent_r                                      e   0.000000E+00    0.000000E+00    0.000000E+00              9.00000E+100
         83  traj.linkages.ascent|descent_time                                   e   0.000000E+00    1.776357E-15    0.000000E+00              9.00000E+100
         84  traj.linkages.ascent|descent_v                                      e   0.000000E+00    0.000000E+00    0.000000E+00              9.00000E+100
         85  traj.phases.ascent.initial_boundary_constraints.initial_value:ke    i   0.000000E+00    4.000000E+00    4.000000E+00         u    9.00000E+100

--------------------------------------------------------------------------------

[3183.25405878]

Simulating trajectory traj
INFO: checking out_of_order
INFO: checking system
INFO: checking solvers
INFO: checking dup_inputs
INFO: checking missing_recorders
WARNING: The Problem has no recorder of any kind attached
INFO: checking comp_has_no_outputs
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/dymos/phase/phase.py:255: DeprecationWarning:The default behavior of &#x27;targets=_unspecified&#x27; is changing. It is currently equivalent to targets=None&#x27;, but in the future it will try to automatically connect to ODE inputs. Set targets=None to retain the old behavior.
/home/travis/build/OpenMDAO/dymos/OpenMDAO/openmdao/utils/options_dictionary.py:504: DeprecationWarning:The option &#x27;user_teriminate_signal&#x27; was misspelled and will be deprecated. Please use &#x27;user_terminate_signal&#x27; instead.
Done simulating trajectory traj
optimal radius: 0.0419 m 
cannonball mass: 2.4168 kg 
launch angle: 32.0215 deg 
maximum range: 3183.2541 m 
</pre></div></div><div class="figure align-default">
<img alt="../_images/doc_plot_8.png" src="../_images/doc_plot_8.png" />
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Multi-Phase Cannonball</a><ul>
<li><a class="reference internal" href="#using-two-phases-to-capture-an-intermediate-boundary-constraint">Using two phases to capture an intermediate boundary constraint</a></li>
<li><a class="reference internal" href="#designing-a-cannonball-for-maximum-range">Designing a cannonball for maximum range</a></li>
<li><a class="reference internal" href="#building-and-running-the-problem">Building and running the problem</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="min_time_climb.html"
                        title="previous chapter">Supersonic Interceptor Minimum Time Climb</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="multibranch_trajectory.html"
                        title="next chapter">Multibranch Trajectory</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/multi_phase_cannonball.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="multibranch_trajectory.html" title="Multibranch Trajectory"
             >next</a> |</li>
        <li class="right" >
          <a href="min_time_climb.html" title="Supersonic Interceptor Minimum Time Climb"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">dymos 0.15.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" >Dymos by Example</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Multi-Phase Cannonball</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, National Aeronautics and Space Administration.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>